<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vintage Incubation Puzzle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* FONT SETUP */
        @font-face {
            font-family: 'Caslon Antique';
            src: url('caslon-antique.woff2') format('woff2'),
                 url('caslon-antique.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        body {
            background-color: #3a302a;
            background-image:
                radial-gradient(ellipse at center, rgba(0,0,0,0) 0%, rgba(0,0,0,0.35) 100%),
                url('https://www.transparenttextures.com/patterns/subtle-grunge.png'),
                url('image_17ea9b.jpg');
            background-size: cover, auto, cover;
            background-position: center, center, center;
            background-attachment: fixed;

            font-family: 'Caslon Antique', serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }

        #a4-sheet {
            width: 100%;
            max-width: 8.27in;
            min-height: 11.7in;
            padding: 1.5rem;
            background-color: rgba(245, 241, 227, 0.88);
            backdrop-filter: blur(4px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            border: 1px solid #4a382a;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #main-container {
             border: 1px double #a1887f;
             padding: 2rem;
             box-shadow: inset 0 0 20px rgba(0,0,0,0.25);
             background-color: rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 8.5in) {
            body { padding: 0; }
            #a4-sheet {
                min-height: 100vh;
                border: none;
                padding: 1rem;
                background-color: rgba(245, 241, 227, 0.92);
            }
            #main-container { padding: 1.5rem; }
        }

        /* Enhanced Vintage Title Styling */
        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        .title-container::before, .title-container::after {
            content: '';
            flex-grow: 1;
            height: 1px;
            background: #8D6E63;
            opacity: 0.7;
        }
        .vintage-title {
            color: #3E2723;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            padding: 0 0.5rem;
            white-space: nowrap;
        }
        .title-flourish {
            color: #8D6E63;
            font-size: 1.5rem;
            vertical-align: middle;
            margin: 0 0.25rem;
        }

        /* Pictorial Clue Styling */
        #clue-image {
            border: 5px solid #d7ccc8;
            padding: 3px;
            background-color: #fff;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.35);
            filter: sepia(0.6) contrast(0.9) brightness(1.05);
            transition: transform 0.3s ease-in-out;
        }
        #clue-image:hover {
            transform: scale(1.05) rotate(1deg);
        }
        
        #clue-text { min-height: 2.5rem; }

        .scrambled-word {
            letter-spacing: 0.5em;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold; font-size: 2rem; color: #4E342E;
            background-color: rgba(215, 204, 188, 0.4);
            padding: 1.5rem 1rem;
            border: 1px solid rgba(141, 110, 99, 0.5);
            border-radius: 2px;
            box-shadow: inset 0 1px 4px rgba(0,0,0,0.15);
        }

        .vintage-input {
            background-color: rgba(255, 253, 250, 0.8);
            border: 1px solid #A1887F;
            border-radius: 2px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            color: #3E2723;
            font-family: 'Times New Roman', Times, serif;
            font-size: 1.1rem; transition: all 0.3s ease;
        }
        .vintage-input:focus {
            outline: none; border-color: #5D4037;
            box-shadow: 0 0 0 3px rgba(93, 64, 55, 0.2);
        }

        .vintage-button {
            background-color: #5D4037; color: #F5F5F5;
            font-weight: bold; border-radius: 2px;
            text-transform: uppercase; letter-spacing: 0.1em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        .vintage-button:hover {
            background-color: #4E342E;
            box-shadow: 0 4px 8px rgba(0,0,0,0.25);
            transform: translateY(-1px);
        }

        .feedback { transition: opacity 0.5s ease-in-out; }
        .hidden-feedback { opacity: 0; }
        .error-animation { animation: error-shake 0.5s ease; }
        @keyframes error-shake {
            0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-5px); } 40%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div id="a4-sheet">
        <div id="main-container" class="w-full max-w-lg text-center">
            <div id="title-wrapper" class="title-container">
                 <h1 id="header-title" class="vintage-title text-4xl sm:text-5xl">
                    <span class="title-flourish">☙</span>
                    Incubation Puzzle
                    <span class="title-flourish">☙</span>
                </h1>
            </div>

            <p id="progress-text" class="text-stone-700 mb-2 text-lg">Unscramble the word below!</p>
            
            <div id="game-content">
                <div id="clue-container" class="my-2 h-32 flex justify-center items-center">
                    <img id="clue-image" src="" alt="Clue" class="max-h-full max-w-full object-contain rounded-sm">
                </div>
                <p id="clue-text" class="text-stone-700 italic text-center px-4"></p>

                <div id="game-area" class="mt-4">
                    <div class="mb-6">
                        <p id="scrambled-word" class="scrambled-word uppercase select-none"></p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-4 mb-4">
                        <input type="text" id="answer-input" placeholder="Your answer..." class="vintage-input flex-grow w-full px-4 py-3 focus:outline-none placeholder-stone-500">
                        <button id="submit-btn" class="vintage-button w-full sm:w-auto py-3 px-8">Submit</button>
                    </div>
                    <div id="feedback-message" class="feedback hidden-feedback h-8 flex items-center justify-center">
                        <p class="text-xl"></p>
                    </div>
                </div>
            </div>
            
            <form id="user-details-form" class="hidden text-left">
                <div class="space-y-4">
                    <div>
                        <label for="name-input" class="block mb-2 font-bold text-stone-800">Full Name</label>
                        <input type="text" id="name-input" class="vintage-input block w-full p-2.5" placeholder="John Doe" required>
                    </div>

                    <fieldset>
                        <legend class="block mb-2 font-bold text-stone-800">Are you a student or faculty?</legend>
                        <div class="flex items-center gap-x-4">
                            <label><input type="radio" name="user-role" value="Student" class="mr-2" required> Student</label>
                            <label><input type="radio" name="user-role" value="Faculty" class="mr-2"> Faculty</label>
                        </div>
                    </fieldset>

                    <div>
                        <label for="dept-input" class="block mb-2 font-bold text-stone-800">Department</label>
                        <input type="text" id="dept-input" class="vintage-input block w-full p-2.5" placeholder="e.g., Computer Science" required>
                    </div>

                    <div>
                        <label for="phone-input" class="block mb-2 font-bold text-stone-800">Phone Number</label>
                        <input type="tel" id="phone-input" class="vintage-input block w-full p-2.5" placeholder="10-digit number" pattern="[0-9]{10}" required>
                    </div>

                    <div>
                        <label for="email-input" class="block mb-2 font-bold text-stone-800">Official KPRCAS Email ID</label>
                        <input type="email" id="email-input" class="vintage-input block w-full p-2.5" placeholder="yourname@kprcas.ac.in" required>
                        <p id="email-error" class="mt-2 text-sm text-red-800 hidden">Please enter a valid KPRCAS email address.</p>
                    </div>
                </div>
                <button type="submit" id="form-submit-btn" class="mt-6 w-full text-white bg-green-800 hover:bg-green-900 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-sm text-sm px-5 py-2.5 text-center uppercase tracking-wider">Submit Details</button>
            </form>

            <div id="whatsapp-link-container" class="hidden">
                 <p class="text-stone-700 mb-4 text-lg">Thank you! Click the number below to send your details and claim your reward.</p>
                <a id="whatsapp-link" href="#" target="_blank" class="text-3xl font-bold text-blue-800 hover:underline">
                    8903777979
                </a>
                <button id="restart-btn" class="mt-8 block w-full vintage-button bg-stone-600 hover:bg-stone-700">Play Again</button>
            </div>
        </div>
    </div>

    <script>
        const puzzles = [
            { word: 'BOOTSTRAPPING', imageUrl: 'https://picsum.photos/seed/boot/150/150',      clue: 'Funding a company with personal finances or revenue.' },
            { word: 'CAPTABLE',      imageUrl: 'https://picsum.photos/seed/chart/150/150',     clue: 'A spreadsheet detailing equity ownership.' },
            { word: 'ACQUIHIRE',     imageUrl: 'https://picsum.photos/seed/talent/150/150',    clue: 'Buying a company primarily for its staff.' },
            { word: 'DECACORN',      imageUrl: 'https://picsum.photos/seed/diamond/150/150',   clue: 'A startup valued at over $10 billion.' },
            { word: 'GAMIFICATION',  imageUrl: 'https://picsum.photos/seed/game/150/150',      clue: 'Applying game-design elements to non-game contexts.' },
            { word: 'ROADMAP',       imageUrl: 'https://picsum.photos/seed/map/150/150',       clue: 'A strategic plan showing the evolution of a product.' },
            { word: 'LEVERAGE',      imageUrl: 'https://picsum.photos/seed/lever/150/150',     clue: 'Using borrowed capital for an investment.' },
            { word: 'INCUMBENT',     imageUrl: 'https://picsum.photos/seed/king/150/150',      clue: 'The existing holder of a market position.' },
            { word: 'HEADWINDS',     imageUrl: 'https://picsum.photos/seed/wind/150/150',      clue: 'External conditions that hinder growth.' },
            { word: 'BURNRATE',      imageUrl: 'https://picsum.photos/seed/fire/150/150',      clue: 'The speed at which a company spends its capital.' }
        ];

        let currentWordIndex = 0;
        let score = 0;
        let shuffledPuzzles = [];
        const titleWrapper = document.getElementById('title-wrapper');
        const headerTitle = document.getElementById('header-title');
        const progressTextEl = document.getElementById('progress-text');
        const gameContent = document.getElementById('game-content');
        const userDetailsForm = document.getElementById('user-details-form');
        const whatsappContainer = document.getElementById('whatsapp-link-container');
        const nameInput = document.getElementById('name-input');
        const deptInput = document.getElementById('dept-input');
        const phoneInput = document.getElementById('phone-input'); // NEW
        const emailInput = document.getElementById('email-input');
        const emailError = document.getElementById('email-error');
        const whatsappLink = document.getElementById('whatsapp-link');
        const restartBtn = document.getElementById('restart-btn');
        // ... other element selections ...
        
        // --- Functions for the game logic ---
        function shuffleArray(array) { /* ... */ }
        function scrambleWord(word) { /* ... */ }
        function nextWord() { /* ... */ }
        function checkAnswer() { /* ... */ }

        function endGame() {
            gameContent.classList.add('hidden');
            userDetailsForm.classList.remove('hidden');
            
            // NEW: Update heading and text for Reward Corner
            const titleText = headerTitle.childNodes[1]; // Get the text node
            titleText.nodeValue = ' Reward Corner ';
            
            progressTextEl.textContent = `You scored ${score} out of ${shuffledPuzzles.length}! Claim your reward by filling the details.`;
            nameInput.focus();
        }

        function handleFormSubmit(event) {
            event.preventDefault();
            const name = nameInput.value.trim();
            const department = deptInput.value.trim();
            const phone = phoneInput.value.trim();
            const email = emailInput.value.trim().toLowerCase();
            
            // Get selected role (Student/Faculty)
            const userRoleElement = document.querySelector('input[name="user-role"]:checked');
            if (!userRoleElement) {
                alert('Please select if you are a student or faculty.');
                return;
            }
            const userRole = userRoleElement.value;

            // Validation
            if (!email.endsWith('@kprcas.ac.in')) {
                emailError.classList.remove('hidden');
                return;
            }
            emailError.classList.add('hidden');
            if (!name || !department || !phone) {
                alert("Please fill in all fields.");
                return;
            }

            userDetailsForm.classList.add('hidden');
            whatsappContainer.classList.remove('hidden');
            
            progressTextEl.textContent = 'Thank you! Click the number below to send your details and claim your reward.';

            // NEW: Construct comprehensive WhatsApp message
            const phoneNumber = '918903777979'; // Your number
            const message = `--- Reward Corner Details ---\n\n` +
                          `Name: ${name}\n` +
                          `Role: ${userRole}\n` +
                          `Department: ${department}\n` +
                          `Phone: ${phone}\n` +
                          `Email: ${email}`;
            
            const encodedMessage = encodeURIComponent(message);
            whatsappLink.href = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
        }
        
        function startGame() {
            currentWordIndex = 0;
            score = 0;
            shuffledPuzzles = shuffleArray([...puzzles]);
            
            const titleText = headerTitle.childNodes[1];
            titleText.nodeValue = ' Incubation Puzzle ';
            
            gameContent.classList.remove('hidden');
            userDetailsForm.classList.add('hidden');
            whatsappContainer.classList.add('hidden');
            emailError.classList.add('hidden');
            
            nextWord();
        }
        
        // Add full function bodies here from previous steps
        const scrambledWordEl = document.getElementById('scrambled-word');
        const clueImageEl = document.getElementById('clue-image');
        const clueTextEl = document.getElementById('clue-text');
        const answerInputEl = document.getElementById('answer-input');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const mainContainer = document.getElementById('main-container');

        shuffleArray = function(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; };
        scrambleWord = function(word) { let scrambled = word.split('').sort(() => 0.5 - Math.random()).join(''); return (scrambled === word && word.length > 1) ? scrambleWord(word) : scrambled; };
        nextWord = function() { if (currentWordIndex < shuffledPuzzles.length) { const currentPuzzle = shuffledPuzzles[currentWordIndex]; scrambledWordEl.textContent = scrambleWord(currentPuzzle.word); clueImageEl.src = currentPuzzle.imageUrl; clueTextEl.textContent = currentPuzzle.clue; answerInputEl.value = ''; answerInputEl.focus(); progressTextEl.textContent = `Word ${currentWordIndex + 1} of ${shuffledPuzzles.length}`; } else { endGame(); } };
        checkAnswer = function() { const userAnswer = answerInputEl.value.trim().toUpperCase(); const correctAnswer = shuffledPuzzles[currentWordIndex].word; const feedbackTextEl = feedbackMessageEl.querySelector('p'); if (userAnswer === correctAnswer) { score++; feedbackTextEl.textContent = 'Correct!'; feedbackTextEl.className = 'text-xl font-bold text-green-800'; currentWordIndex++; setTimeout(() => { nextWord(); feedbackMessageEl.classList.add('hidden-feedback'); }, 1000); } else { feedbackTextEl.textContent = 'Try again!'; feedbackTextEl.className = 'text-xl font-bold text-red-800'; mainContainer.classList.add('error-animation'); answerInputEl.focus(); setTimeout(() => { mainContainer.classList.remove('error-animation'); }, 500); } feedbackMessageEl.classList.remove('hidden-feedback'); };
        
        document.getElementById('submit-btn').addEventListener('click', checkAnswer);
        answerInputEl.addEventListener('keyup', (e) => e.key === 'Enter' && checkAnswer());
        userDetailsForm.addEventListener('submit', handleFormSubmit);
        restartBtn.addEventListener('click', startGame);

        startGame();
    </script>
</body>
</html>
